<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ph·∫ßn M·ªÅm Ri√™ng C·ªßa B√© Tu·ªá Minh</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="container">
    <h1>üè¢ Ph·∫ßn M·ªÅm Ri√™ng C·ªßa B√© Tu·ªá Minh</h1>
    
    <!-- Th√¥ng b√°o -->
    <div id="notification" class="hidden"></div>
    
    <!-- Th·ªëng k√™ -->
    <div id="statisticsBox" class="stats-box hidden">
      <div class="stats-item">ƒêang t·∫£i th·ªëng k√™...</div>
    </div>

    <!-- File Selection & Configuration -->
    <div class="file-config-section">
      <h3>üìÅ B·∫Øt ƒë·∫ßu m√¨nh c·∫•u h√¨nh File Excel m·ªôt t√≠</h3>
      
      <!-- File Selection -->
      <div class="file-selection">
        <div class="form-group">
          <label>B√© ch·ªçn ƒëi:</label>
          <div class="file-input-group">
            <input type="text" id="selectedFilePath" readonly placeholder="B√© ch∆∞a ch·ªçn file...">
            <button type="button" class="btn btn-primary" id="selectFileBtn">üìÇ B·∫•m ƒë√¢y n√® b√©</button>
          </div>
        </div>
      </div>

      <!-- Sheet Selection -->
      <div class="sheet-selection hidden">
        <div class="form-group">
          <label for="sheetSelect">Ch·ªçn file xong r·ªìi gi·ªù m√¨nh ch·ªçn Sheet:</label>
          <div class="sheet-input-group">
            <select id="sheetSelect">
              <option value="">-- B·∫•m v√†o ƒë√¢y ƒë·ªÉ ch·ªçn Sheet n√® --</option>
            </select>
            <button type="button" class="btn btn-warning" id="reloadSheetsBtn">üîÑ R√¨ Lo√°t</button>
          </div>
        </div>
      </div>

      <!-- Reading Configuration -->
      <div class="reading-config hidden">
        <h4>‚öôÔ∏è B√© c√†i ƒë·∫∑t c·∫•u h√¨nh cho n√≥ nha</h4>
        <div class="form-row">
          <div class="form-group">
            <label for="skipRows">B√© nh·∫≠p s·ªë d√≤ng anh c·∫ßn b·ªè qua (b·ªè qua m·∫•y d√≤ng ƒë·∫ßu kh√¥ng c√≥ d·ªØ li·ªáu √°):</label>
            <input type="number" id="skipRows" value="5" min="0" max="100">
          </div>
          <div class="form-group">
            <label for="takeRows">B√© nh·∫≠p s·ªë d√≤ng anh c·∫ßn l·∫•y (ƒë·ªÉ 0 l√† l·∫•y h·∫øt lu√¥n):</label>
            <input type="number" id="takeRows" value="0" min="0" placeholder="0 l√† ƒë·ªçc h·∫øt sheet">
          </div>
        </div>
        <div class="config-actions">
          <button type="button" class="btn btn-warning" id="previewDataBtn">üëÅÔ∏è Xem Tr∆∞·ªõc</button>
          <button type="button" class="btn btn-success" id="readDataBtn">üìñ L·∫•y D·ªØ Li·ªáu</button>
          <button type="button" class="btn btn-secondary" id="resetFileBtn">üîÑ Ch·ªçn File Kh√°c</button>
        </div>
      </div>

      <!-- Preview Area -->
      <div id="dataPreview" class="data-preview hidden">
        <h4>üëÅÔ∏è Xem Tr∆∞·ªõc D·ªØ Li·ªáu</h4>
        <div id="previewContent"></div>
      </div>
    </div>
    
    <!-- Danh s√°ch nh√¢n vi√™n -->
    <div class="table-section hidden">
      <div class="controls-section">
        <div class="table-header">
          <h3>üë• Danh S√°ch Nh√¢n Vi√™n</h3>
          <button type="button" class="btn btn-success" id="addEmployeeBtn">
            ‚ûï Th√™m Nh√¢n Vi√™n
          </button>
        </div>
        
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm nh√¢n vi√™n..." />
        </div>
        
        <div class="filter-box">
          <select id="filterDepartment">
            <option value="">T·∫•t c·∫£ ph√≤ng ban</option>
          </select>
          
          <select id="filterPosition">
            <option value="">T·∫•t c·∫£ ch·ª©c v·ª•</option>
          </select>
          
          <select id="filterStatus">
            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
          </select>
          
          <button type="button" class="btn btn-secondary" onclick="employeeManager.clearFilters()">
            X√≥a b·ªô l·ªçc
          </button>
        </div>
      </div>
      
      <div style="margin-bottom: 15px;">
        <span>T·ªïng s·ªë: <strong id="totalCount">0</strong> nh√¢n vi√™n</span>
      </div>
      
      <div id="loadingIndicator" class="loading hidden">ƒêang t·∫£i d·ªØ li·ªáu...</div>
      
      <div class="table-container">
        <table id="employeeTable" class="employee-table">
          <thead>
            <tr>
              <th>STT</th>
              <th>M√£ NV</th>
              <th>H·ªç v√† t√™n</th>
              <th>Ch·ª©c v·ª•</th>
              <th>Ph√≤ng ban</th>
            </tr>
          </thead>
          <tbody id="employeeTableBody">
            <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c load ƒë·ªông -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Employee Modal -->
  <div id="employeeModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Th√™m Nh√¢n Vi√™n M·ªõi</h3>
        <span class="close" id="closeModal">&times;</span>
      </div>
      
      <div class="modal-body">
        <form id="employeeModalForm">
          <div class="form-group">
            <label for="modalId">M√£ Nh√¢n Vi√™n:</label>
            <input type="text" id="modalId" name="id" required>
          </div>
          
          <div class="form-group">
            <label for="modalFullName">H·ªç v√† T√™n:</label>
            <input type="text" id="modalFullName" name="fullName" required>
          </div>
          
          <div class="form-group">
            <label for="modalPosition">Ch·ª©c V·ª•:</label>
            <select id="modalPosition" name="position">
              <option value="">Ch·ªçn ch·ª©c v·ª•</option>
              <!-- Options s·∫Ω ƒë∆∞·ª£c load t·ª´ config -->
            </select>
          </div>
          
          <div class="form-group">
            <label for="modalDepartment">Ph√≤ng Ban:</label>
            <select id="modalDepartment" name="department">
              <option value="">Ch·ªçn ph√≤ng ban</option>
              <!-- Options s·∫Ω ƒë∆∞·ª£c load t·ª´ config -->
            </select>
          </div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-success" id="saveEmployeeBtn">üíæ L∆∞u</button>
        <button type="button" class="btn btn-danger" id="deleteEmployeeBtn" style="display: none;">üóëÔ∏è X√≥a</button>
        <button type="button" class="btn btn-secondary" id="cancelModalBtn">‚ùå H·ªßy</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/utils.js"></script>
  <script src="js/EmployeeService.fe.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
